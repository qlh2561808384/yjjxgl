var arr_nodeid=new Array(),arr_nodename=new Array(),arr_nodeurl=new Array();$.fn.atree=function(d){var h=$(this);var a;var g={data:{simpleData:{enable:true,idKey:"id",pIdKey:"pId",rootPId:"0"},key:{checked:"checked",children:"children",name:"name",title:"",url:""}}};d=$.extend({},g,d);if(d.localdata!=null){a=$.fn.zTree.init(h,d,d.localdata)}else{if(d.url!=null){$.dajax({url:d.url,async:false,success:function(i){a=$.fn.zTree.init(h,d,i)}})}else{a=$.fn.zTree.init(h,d)}}var b=$.fn.zTree.getZTreeObj("treeSide");var f=b.getNodes();var c=b.transformToArray(f);for(var e=0;e<c.length;e++){if(c[e][b.setting.data.key.url]){arr_nodeid.push(c[e][b.setting.data.simpleData.idKey]);arr_nodename.push(c[e][b.setting.data.key.name]);arr_nodeurl.push(c[e][b.setting.data.key.url])}}var c=a.transformToArray(a.getNodes());for(var e=0;e<c.length;e++){if(c[e].isOpen){a.expandNode(c[e],true,true,true)}}return a};var curExpandNode=null;function beforeExpand(f,e){var d=curExpandNode?curExpandNode.getParentNode():null;var g=e.parentTId?e.getParentNode():null;var b=$.fn.zTree.getZTreeObj("treeSide");for(var c=0,a=!g?0:g.children.length;c<a;c++){if(e!==g.children[c]){b.expandNode(g.children[c],false)}}while(d){if(d===e){break}d=d.getParentNode()}if(!d){singlePath(e)}}function singlePath(l){if(l===curExpandNode){return}var g=$.fn.zTree.getZTreeObj("treeSide"),a,h,e,f,d,b;if(!curExpandNode){h=l;while(h){e=h.tId;h=h.getParentNode()}a=g.getNodes();for(f=0,d=a.length;f<d;f++){b=a[f];if(b.tId!=e){g.expandNode(b,false)}}}else{if(curExpandNode&&curExpandNode.open){if(l.parentTId===curExpandNode.parentTId){g.expandNode(curExpandNode,false)}else{var m=[];while(l){l=l.getParentNode();if(l===curExpandNode){m=null;break}else{if(l){m.push(l)}}}if(m!=null){var c=curExpandNode;var k=[];while(c){c=c.getParentNode();if(c){k.push(c)}}if(m.length>0){g.expandNode(k[Math.abs(k.length-m.length)-1],false)}else{g.expandNode(k[k.length-1],false)}}}}}curExpandNode=l}function onExpand(a,c,b){curExpandNode=b}var openNewTab=function(f,g,b){var d=$("#myTab");var l=$("#myTabContent");var m=$(".tab_btn");var j=$(".tab_wrap");var h;var c=$(".tabBox").outerWidth();if(f){mytabWid=d.outerWidth(true);if($("#tabli-"+b).length==0){var a='<li class="active" id="tabli-'+b+'"><a href="#tab-'+b+'" id="tabclose-'+b+'" data-toggle="tab">'+g+' <i class="fa fa-times-circle"></i></a></li>';var i="";i+='<div class="tab-pane fade in active" id="tab-'+b+'">';i+='<iframe src="'+f+'" frameborder="0" class="iframeCon" id="iframe-'+b+'" width="100%" height="'+iframeheight+'"></iframe>';i+="</div>";d.find("li").removeClass("active");l.find(".tab-pane").removeClass("in active");d.append(a);l.append(i);m.find(".closeAll").removeClass("hide");h=c-m.outerWidth(true);mytabWid+=$("#tabli-"+b).width();if(mytabWid>h){m.find(".showtab").removeClass("hide");h=c-m.outerWidth(true);d.width(mytabWid)}else{d.width("auto")}j.width(h);d.animate({left:"-"+(mytabWid-h)+"px"},200)}else{$("#tabli-"+b).addClass("active").siblings().removeClass("active");$("#tab-"+b).addClass("in active").siblings().removeClass("in active");h=c-m.outerWidth(true);if(mytabWid>h){var e=$("#tabli-"+b).position().left;var k=mytabWid-e;if(k<=h){d.animate({left:"-"+(mytabWid-h)+"px"},500)}else{d.animate({left:"-"+e+"px"},500)}}}$(window).resize(function(){h=$(".tabBox").outerWidth()-m.outerWidth(true);j.width(h)});$("#tabclose-"+b+" .fa-times-circle").on("click",function(){mytabWid-=$("#tabli-"+b).width();d.width(mytabWid);if(d.find("li").length==2){m.find(".closeAll").addClass("hide");j.width("auto");d.removeAttr("style")}h=c-m.outerWidth(true);var q=Math.abs(parseInt(d.css("left")));var p=Math.abs(mytabWid-h);if((mytabWid>h)&&(p!=q)){d.animate({left:"-"+p+"px"},500)}else{if(mytabWid<=h){m.find(".showtab").addClass("hide");h=$(".tabBox").outerWidth()-m.outerWidth(true);j.width(h);d.removeAttr("style").animate({left:0},500)}}var o=$(this).parents("li");var n=o.find("a").attr("href");if(o.hasClass("active")){o.prev().addClass("active");$(n).prev().addClass("in active")}o.remove();$(n).remove()})}};function onClick(h,f,d){var b=$.fn.zTree.getZTreeObj("treeSide");b.expandNode(d,null,null,null,true);var g=d[b.setting.data.key.url];var a=d[b.setting.data.key.name];var c=d[b.setting.data.simpleData.idKey];openNewTab(g,a,c)}var iframeheight;var mytabWid;var windowHeight=$(window).height();$(document).ready(function(){mytabWid=$("#myTab li:eq(0)").outerWidth(true)+5;$(".main-content").css({height:windowHeight});iframeheight=windowHeight-$(".navbar").outerHeight()-$(".tab_wrap").outerHeight(true)-10;$(".iframeCon").height(iframeheight);var b=windowHeight-$(".userInfo").outerHeight()-$(".sidebar-toggle").outerHeight();$(".tree_side").css({maxHeight:b});$(".closeAll").click(function(){$("#myTab li:not(:eq(0))").remove();$("#myTab li:eq(0)").addClass("active");$("#myTabContent .tab-pane:not(:eq(0))").remove();$("#myTabContent .tab-pane:eq(0)").addClass("in active");mytabWid=$("#myTab li:eq(0)").outerWidth(true)+5;$("#myTab").removeAttr("style");$(".tab_btn a").addClass("hide");$(".tab_wrap").width("auto")});var a=$(".tab_wrap").outerWidth()/2;$(".showRightTabs").on("click",function(){var i=$("#myTab");var d=$(".tab_wrap").width();var h=Math.abs(parseInt(i.css("left")));var c=0;i.find("li").each(function(){c+=$(this).outerWidth(true)});var f=c-d;if(!i.is(":animated")){if(h>=f){i.stop()}else{var e=Math.abs(f-h);var g=0;if(e<a){g=e}else{g=a}i.animate({left:"-="+g+"px"},500)}}});$(".showLeftTabs").click(function(){var e=$("#myTab");var d=Math.abs(parseInt(e.css("left")));if(!e.is(":animated")){if(d==0){e.stop()}else{var c=0;if(d<a){c=d}else{c=a}e.animate({left:"+="+c+"px"},500)}}});$("#sidebar-collapse").on("click",function(){var h=$("#sidebar");var g=$(this);var e=g.find("i");var d=e.attr("data-icon1");var c=e.attr("data-icon2");if(h.hasClass("menu-min")){h.removeClass("menu-min");e.removeClass().addClass(d)}else{h.addClass("menu-min");e.removeClass().addClass(c)}var f;if($("#myTab li").length==1){f=0}else{f=$(".tab_btn").outerWidth(true)}$(".tab_wrap").width($(".tabBox").outerWidth()-f);$(window).resize(function(){$(".tab_wrap").width($(".tabBox").outerWidth()-f)})});$("#rightSide_ico").on("click",function(){var c=$(".rightSide");if(c.hasClass("menu-min")){c.removeClass("menu-min")}else{c.addClass("menu-min")}})});