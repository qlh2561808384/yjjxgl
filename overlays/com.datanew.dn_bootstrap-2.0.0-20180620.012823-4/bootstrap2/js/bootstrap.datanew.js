var __bootstrapVersionPath="bootstrap2";(function($){$.extend({getRootPath:function(){var curWwwPath=window.document.location.href;var pathName=window.document.location.pathname;var pos=curWwwPath.indexOf(pathName);var localhostPaht=curWwwPath.substring(0,pos);var projectName=pathName.substring(0,pathName.substr(1).indexOf("/")+1);if("file://"===localhostPaht){var lastpath=curWwwPath.substr(curWwwPath.lastIndexOf("/bootstrap/")+11,curWwwPath.length);var str=lastpath.split("/");var returnstr="";for(var i=0;i<str.length;i++){if(i==str.length-1){returnstr+=".."}else{returnstr+="../"}}return returnstr}else{return(localhostPaht+projectName)}},include:function(file){var includePath=$.getRootPath();var files=typeof file=="string"?[file]:file;for(var i=0;i<files.length;i++){var values=files[i].split("|");var name=values[0].replace(/^\s|\s$/g,"");var att=name.split(".");var ext=att[att.length-1].toLowerCase();var isCSS;var tag;var attr;if(ext=="css"){isCSS=true;tag="link";attr=" type='text/css' rel='stylesheet' "}else{if(ext=="less"){isCSS=true;tag="link";attr=" type='text/css' rel='stylesheet/less' "}else{isCSS=false;tag="script";attr=" language='javascript' type='text/javascript' "}}var debugParam=$.debugModal==true?"?a="+Math.random():"";var findlink=(isCSS?"href":"src")+"^='"+includePath+"/"+name+"'";var link=(isCSS?"href":"src")+"='"+includePath+"/"+name+debugParam+"'";if($(tag+"["+findlink+"]").length===0){if(values.length==3){var name2=values[2].replace(/^\s|\s$/g,"");var att2=name2.split(".");var ext2=att2[att2.length-1].toLowerCase();var isCSS2=ext2=="css";var tag2=isCSS2?"link":"script";if(values[1]=="before"){findlink=(isCSS2?"href":"src")+"^='"+includePath+"/"+values[2]+"'";if($(tag2+"["+findlink+"]").length!==0){$(tag2+"["+findlink+"]").before("<"+tag+attr+link+"></"+tag+">")}else{$("head").append("<"+tag+attr+link+"></"+tag+">")}}else{if(values[1]=="after"){findlink=(isCSS2?"href":"src")+"^='"+includePath+"/"+values[2]+"'";if($(tag2+"["+findlink+"]").length!==0){$(tag2+"["+findlink+"]").after("<"+tag+attr+link+"></"+tag+">")}else{$("head").append("<"+tag+attr+link+"></"+tag+">")}}else{if(values[1]=="likebefore"){findlink=(isCSS2?"href":"src")+"*='"+values[2]+"'";if($(tag2+"["+findlink+"]").length!=0){$(tag2+"["+findlink+"]").before("<"+tag+attr+link+"></"+tag+">")}else{$("head").append("<"+tag+attr+link+"></"+tag+">")}}else{if(values[1]=="likeafter"){findlink=(isCSS2?"href":"src")+"*='"+values[2]+"'";if($(tag2+"["+findlink+"]").length!=0){$(tag2+"["+findlink+"]").after("<"+tag+attr+link+"></"+tag+">")}else{$("head").append("<"+tag+attr+link+"></"+tag+">")}}else{$("head").append("<"+tag+attr+link+"></"+tag+">")}}}}}else{$("head").append("<"+tag+attr+link+"></"+tag+">")}}}},dcookie:function(){$.include(__bootstrapVersionPath+"/plugins/cookie/jquery.cookie.js");var args=Array.prototype.slice.call(arguments,0);return $.cookie.apply(null,args)},dzoom:function(zoom){$body.css({"-moz-transform":"scale("+zoom+")","transform-origin":"center top"});$body.css("zoom",zoom)},replaceTag:function($target,tagName){var target=$target.get(0),attrs=target.attributes,$newTag=$("<"+tagName+">");if(target.tagName==tagName){return $target}$.each(attrs,function(i,attr){$newTag.attr(attr.name,attr.value)});$target.after($newTag).remove();return $newTag},initPage:function(option){var $container=$(document).find("body");if(typeof option!="object"){throw new Error("初始化参数类型不正确")}if($container.length==0){$(document).append("<body></body>");$container=$(document).find("body")}parse(option,$container);function parse(option,$parent){$.each(option,function(){var $target=$("<DIV>"),dtype=this.dtype;$parent.append($target);if(dtype=="column"){$target.addClass("column col-sm-"+this.colspan)}else{if(dtype=="row"){$target.addClass("row")}else{if(dtype=="body"){$target.addClass("container-fluid")}else{if(dtype=="html"){$target.remove();$target=$(this.dragHtml);$parent.append($target);$target.removeAttr("contenteditable").removeClass("layoutClass");$.each($target,function(i){var othis=$target[i];if(othis.id!=null&&othis.id.indexOf("layoutClass_")!=-1){othis.id=""}if(!!option[0].id){$(othis).attr("id",option[0].id)}})}else{var dId=!!option[0].id?option[0].id:dtype+"-"+Math.floor(Math.random()*1000000);$target.attr("id",dId);$target[dtype](this)}}}}if(this.plug&&this.plug.length>0){parse(this.plug,$target)}})}}});$.include(__bootstrapVersionPath+"/config/config.js");$.include(__bootstrapVersionPath+"/plugins/input/core1.0.js");var formMthod={initForm:function($target,options){var asyncState={};function formInitCallBack(name){var flag=false;for(var key in asyncState){if(asyncState[key]==false&&key!=name){flag=false;break}else{asyncState[name]=true;flag=true}}if(flag&&options.onLoadedCallBack!=undefined){options.onLoadedCallBack()}}function addLoadedCb(obj){if(obj.url!=null){asyncState[obj.name]=false;obj.formInitCallBack=formInitCallBack}}var setting={rownum:3,labelwidth:"50px",showtitle:"left"};options=$.extend({},setting,options);$target.addClass("form-inline clearfix");$target.addClass("form-sm");$target.html("");if(options.inputs){var colWidth=Math.floor(12/options.rownum);var objsetting={id:null,colspan:1,defaultvalue:"",disabled:false};for(var i=0;i<options.inputs.length;i++){var asyncFlag=false;var obj=options.inputs[i],inputId=obj.id==null?"":' id="'+obj.id+'" ';obj=$.extend({},objsetting,obj);var html="<div class='dform-input form-group dis_flex col-sm-"+colWidth*obj.colspan+"' >";if(obj.type!=null&&options.showtitle=="left"){html+="<label class='control-label' for='' style='width:"+options.labelwidth+" ;line-height:30px'>"+obj.title+"</label>"}var proving=obj.proving==null?"":"proving='"+obj.proving+"'";var dname=obj.dname==null?obj.name:obj.dname;if(obj.type==null){html+="</div>";$target.append(html)}else{if(obj.type=="select"||obj.type=="dselect"){html+="<select "+inputId+' class="form-control flex_val_1"  '+(obj.disabled?"disabled":"")+proving+' dname="'+dname+'"  name="'+obj.name+'"></select></div>';$target.append(html);$target.find(".form-group select:last").dselect(obj);$target.find(".form-group select:last").parent().addClass("flex_val_1")}else{if(obj.type=="ddate"){html+="<input "+inputId+' type="text"  '+(obj.disabled?"disabled":"")+" "+proving+' dname="'+dname+'" name="'+obj.name+'" class="form-control bgwhite" /></div>';$target.append(html);$target.find(".form-group input:last").ddate(obj);var itemwid=$target.width()/(options.rownum*obj.colspan)-30;var datewid=itemwid-parseInt(options.labelwidth);$target.find(".form-group input:last").parent().addClass("flex_val_1").width(datewid)}else{if(obj.type=="dsearchtree"||obj.type=="searchTree"){html+="<input "+inputId+' type="text" '+(obj.disabled?"disabled":"")+" "+proving+' dname="'+dname+'" name="'+obj.name+'" class="form-control" style="width:100%;" /></div>';$target.append(html);addLoadedCb(obj);$target.find(".form-group input:last").searchTree(obj);$target.find(".form-group input:last").parent().addClass("flex_val_1")}else{if(obj.type=="ddecimal"||obj.type=="decimal"){html+="<input "+inputId+' type="number" '+(obj.disabled?"disabled":"")+" "+proving+' dname="'+dname+'" name="'+obj.name+'" class="form-control" style="width:100%;" /></div>';$target.append(html);$target.find(".form-group input:last").decimal(obj);$target.find(".form-group input:last").parent().addClass("flex_val_1")}else{if(obj.type=="html"){html+="<span class='ztreeBox_inp ztreeBox_down flex_val_1'>"+obj.html+"</span>";html+="</div>";$target.append(html)}else{if(obj.type=="hidden"){html+="<input "+inputId+" "+proving+' dname="'+dname+'"  name="'+obj.name+'" type="'+obj.type+'" '+(obj.disabled?"disabled":"")+' class="form-control flex_val_1" '+(obj.placeholder==true?('  placeholder="请输入'+obj.title):"")+'" value="'+obj.defaultvalue+'"></div>';$target.append(html);$target.find(".dform-input:last").hide()}else{if(obj.type=="comboTree"){html+="<input "+inputId+" "+proving+' dname="'+dname+'"  name="'+obj.name+'" type="'+obj.type+'" '+(obj.disabled?"disabled":"")+' class="form-control " '+(obj.placeholder==true?('  placeholder="请输入'+obj.title):"")+'" value="'+obj.defaultvalue+'"></div>';$target.append(html);addLoadedCb(obj);$target.find(".form-group input:last").comboTree(obj);$target.find(".form-group input:last").parent().addClass("flex_val_1")}else{if(obj.type=="textBox"){html+="<input "+inputId+" "+proving+' dname="'+dname+'"  name="'+obj.name+'" type="'+obj.type+'" '+(obj.disabled?"disabled":"")+' class="form-control " style="width:100%;"  value="'+obj.defaultvalue+'"></div>';$target.append(html);if(obj.multiline){var height="";if(!obj.height){height="80px"}else{height=obj.height+"px"}$target.find(".form-group input:last").parent().css("height",height)}$target.find(".form-group input:last").textBox(obj);$target.find(".form-group input:last").parent().addClass("flex_val_1")}else{if(obj.type=="comboBox"){html+="<input "+inputId+"  "+proving+' dname="'+dname+'"  name="'+obj.name+'" type="'+obj.type+'" '+(obj.disabled?"disabled":"")+' class="form-control " '+(obj.placeholder==true?('  placeholder="请输入'+obj.title):"")+'" value="'+obj.defaultvalue+'"></div>';$target.append(html);addLoadedCb(obj);$target.find(".form-group input:last").comboBox(obj);$target.find(".form-group input:last").parent().addClass("flex_val_1")}else{if(obj.type=="dateBox"){html+="<input "+inputId+"  "+proving+' dname="'+dname+'"  name="'+obj.name+'" type="'+obj.type+'" '+(obj.disabled?"disabled":"")+' class="form-control"'+(obj.placeholder==true?('  placeholder="请输入'+obj.title):"")+'" value="'+obj.defaultvalue+'"></div>';$target.append(html);$target.find(".form-group input:last").dateBox(obj);var itemwid=$target.width()/(options.rownum*obj.colspan)-30;var datewid=itemwid-parseInt(options.labelwidth);$target.find(".form-group input:last").parent().addClass("flex_val_1").width(datewid)}else{if(obj.type=="checkbox"){if(!obj.options){return}$.each(obj.options,function(i,option){html+='<lable style="margin-left: 8px;line-height: 30px;">'+option.lable+"</lable>";html+='<input  name="'+obj.name+'" type="checkbox" value="'+option.value+'" style="vertical-align: middle;margin-top: 8px;">'});html+="</div>";$target.append(html)}else{if(obj.type=="webupload"){$.include([__bootstrapVersionPath+"/plugins/webuploader/webuploader.datanew.js"]);html+='<div class="webupload"><div class="uploader"></div></div></div>';$target.append(html);$target.find(".form-group .webupload:last .uploader").webupload(obj);$target.find(".form-group .webupload:last").addClass("flex_val_1").parent().css({height:"auto"})}else{if(obj.type=="webuploadBox"){html+="<input "+inputId+' type="text" '+(obj.disabled?"disabled":"")+" "+proving+' dname="'+dname+'" name="'+obj.name+'" class="form-control" style="width:100%;" /></div>';$target.append(html);$target.find(".form-group input:last").webuploadBox(obj);$target.find(".form-group input:last").parent().addClass("flex_val_1")}else{html+="<input "+inputId+"  "+proving+' dname="'+dname+'"  name="'+obj.name+'" type="'+obj.type+'" '+(obj.disabled?"disabled":"")+' class="form-control flex_val_1" '+(obj.placeholder==true?('  placeholder="请输入'+obj.title):"")+'" value="'+obj.defaultvalue+'"></div>';$target.append(html)}}}}}}}}}}}}}}if(obj.url){asyncFlag=true}}}if(options.formtitle&&options.formtitle!=""){$target.wrapInner("<fieldset class='form-fieldset'></fieldset>");$target.find("fieldset").prepend("<legend class='form-legend'>"+options.formtitle+"</legend>")}if(options.onLoadedCallBack){}},upload:function(param){$(this).ajaxSubmit(param)},submit:function(param){var flag=formMthod.validate.apply(this);if(!flag){return}var data=formMthod.getData.apply(this);if(param.data){var paramdata=param.data;param.data=$.extend({},paramdata,data)}else{param.data=data}$.dajax(param)},getData:function(){var datas=this.serializeArray(),o={};$.each(datas,function(){if(o[this.name]!=undefined){if(!o[this.name].push){o[this.name]=[o[this.name]]}o[this.name].push(this.value||"")}else{o[this.name]=this.value||""}});var uploadBox=$(this).find("[boxType='webupload']");if(uploadBox.length>0){o[uploadBox.attr("name")]=uploadBox.val()}return o},load:function(param){$(this).find("[name]").each(function(){if($(this).attr("boxType")!=undefined&&$(this).attr("name")!=undefined){if($(this).attr("boxType")!="webupload"){$(this).parent().find(".form-control")[$(this).attr("boxType")]("setValue",param[$(this).attr("name")])}}var key=$(this).attr("name");if(param[key]!=null){$(this).val(param[key])}else{$(this).val("")}});formMthod.executeInputMethod.apply(this,["setValue",param])},validate:function(){var flag=true;$("[proving]",this).each(function(){if(!$.dvalidate($(this),true)){flag=false;$(this).change()}});$("[name][boxType]",$(this)).each(function(){if($(this).attr("name")!=undefined&&$(this).attr("boxType")!=undefined){var obj;if($(this).attr("boxType")==="webupload"){obj=$(this).parent()}else{obj=$(this).parent().find(".form-control")}if(!obj[$(this).attr("boxType")]("validate")){flag=false;return false}}});return flag},clear:function(){$(this).clearForm(true);formMthod.executeInputMethod.apply(this,["clear"]);$(this).find(".has-error").each(function(i,item){item.classList.remove("has-error")})},disabled:function(){$(":input",this).each(function(){$(this).attr("readonly",true)});$("select",this).each(function(){$(this).attr("disabled",true)});formMthod.executeInputMethod.apply(this,["disable"])},enable:function(){$(":input",this).each(function(){var boxtype=$(this).siblings(".valueBox").attr("boxtype");if(boxtype!="dateBox"&&boxtype!="searchTree"&&boxtype!="comboBox"&&boxtype!="comboTree"&&boxtype!="webuploadBox"){$(this).removeAttr("readonly")}});$("select",this).each(function(){$(this).attr("disabled",false)});formMthod.executeInputMethod.apply(this,["enable"])},destroy:function(){$(this).find("[name]").each(function(){if($(this).attr("boxType")!=undefined){if($(this).attr("boxType")==="webupload"){$(this).parent()[$(this).attr("boxType")]("destroy")}else{$(this).parent().find(".form-control")[$(this).attr("boxType")]("destroy")}}$(this).remove()})},executeInputMethod:function(method,param){$("[name][boxType]",$(this)).each(function(){if($(this).attr("name")!=undefined&&$(this).attr("boxType")!=undefined){if($(this).attr("boxType")=="webupload"){$(this).parent()[$(this).attr("boxType")](method,method=="setValue"?param[$(this).attr("name")]:param)}else{$(this).parent().find(".form-control")[$(this).attr("boxType")](method,method=="setValue"?param[$(this).attr("name")]:param)}}})}};$.fn.dform=function(options){$.include([__bootstrapVersionPath+"/plugins/form/jquery.form.js",__bootstrapVersionPath+"/plugins/form/form-common.css",__bootstrapVersionPath+"/plugins/form/form-common-custom.css"]);var target=$.replaceTag($(this),"FORM");if(typeof options=="object"){formMthod.initForm(target,options)}else{if(typeof options=="string"){var param=Array.prototype.slice.call(arguments,1);return formMthod[options].apply(this,param)}}};$.fn.ddecimal=function(options){var target=$(this);var setting={title:"dectitle",name:"decname",type:"ddecimal",did:"decimalid",dname:"decimalname",decimalPlaces:2};options=$.extend({},setting,options);var stepnum=1;for(var j=0;j<options.decimalPlaces;j++){stepnum=stepnum/10}target.attr({step:stepnum,value:stepnum});target.addClass("form-control");target.addClass("full");if(options.type=="ddecimal"){target.attr("type","number")}if(options.decimalPlaces>0){target.on("blur",function(){var digit=options.decimalPlaces+1;var val=parseFloat(target.val()).toFixed(digit);var newval=val.substring(0,val.lastIndexOf(".")+digit);target.val(newval)})}};$.fn.ddate=function(options){var target=$(this);var setting={language:"zh-CN",removeIcon:true,disabled:false};options=$.extend({},setting,options);target.wrap('<div class="datepicker"></div>');target.attr({value:options.defaultValue==null?"":options.defaultValue,readonly:"readonly"});target.addClass("form-control");var tparent=target.parent(".datepicker");tparent.addClass("input-group date");var html="";html+='<input type="hidden" name="'+(options.dname==null?"":options.dname)+'" value="'+(options.defaultValue==null?"":options.defaultValue)+'" />';if(options.removeIcon){html+='<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>'}html+='<span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>';target.after(html);$.include([__bootstrapVersionPath+"/plugins/datetimepicker/css/bootstrap-datetimepicker.min.css",__bootstrapVersionPath+"/plugins/datetimepicker/js/bootstrap-datetimepicker.min.js",__bootstrapVersionPath+"/plugins/datetimepicker/js/locales/bootstrap-datetimepicker."+options.language+".js",__bootstrapVersionPath+"/plugins/datetimepicker/css/bootstrap-datetimepicker-custom.css"]);var returnobj=tparent.datetimepicker(options);if(options.disabled){target.attr("disabled","disabled");tparent.find(".input-group-addon").unbind("click")}return returnobj};$.extend({putObj:function(id,obj){if($.fn.dobj==null){$.fn.dobj={}}$.fn.dobj[id]=obj}});$.extend({getObj:function(id){return $.fn.dobj[id]}});$.fn.dtree=function(options){$.include([__bootstrapVersionPath+"/css/font-awesome.min.css",__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/bootstrap-zTree-custom.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js"]);var target=$(this);var tree,treeobj,hideInp;var targetId;if(target.attr("id")){targetId=target.attr("id")}else{targetId="id"+(new Date().getTime());target.attr("id",targetId)}var settings={checkType:"nocheck",ISLEAF:false,isOpen:false,isPopupTree:false,rootElement:false,labelVal:"label",check:{},data:{simpleData:{enable:true,idKey:"id",pIdKey:"pId",rootPId:"0"},key:{checked:"checked",children:"children",name:"name",title:"",url:""}},callback:{}};options=$.extend({},settings,options);target.wrap('<div class="ztreeBox"></div>');if(options.isPopupTree){target.addClass("treeSel form-control");target.attr({readonly:"readonly"});target.before("<lable>"+options.labelVal+"</label>");target.wrap('<div class="ztreeBox_inp ztreeBox_down"></div>');target.after('<ul id="'+targetId+'_tree" class="ztree ztree_abs"></ul>');treeobj=$("#"+targetId+"_tree");target.after('<i class="fa fa-angle-down"></i>');target.css({backgroundColor:"#FFF"});target.before('<input type="hidden" id="'+targetId+'_hideInp"name="'+target.attr("name")+'" value="" />');target.removeAttr("name");hideInp=$("#"+targetId+"_hideInp");target.parent().on("click",function(){showMenu(target,treeobj)})}else{treeobj=target;target.addClass("ztree")}if(options.checkType=="radio"){options.check.enable="true";options.check.chkStyle="radio";options.check.radioType="all"}else{if(options.checkType=="checkbox"){options.check.enable="true"}}var func_click=options.callback.onClick;var func_check=options.callback.onCheck;options.callback.onClick=function(e,treeId,treeNode){onClick(e,treeId,treeNode);if(func_click!=null){func_click(e,treeId,treeNode)}};options.callback.onCheck=function(e,treeId,treeNode){onCheck(e,treeId,treeNode);if(func_check!=null){func_check(e,treeId,treeNode)}};if(options.localdata!=null){if(options.rootElement){var obj={};obj[options.data.simpleData.idKey]=options.data.simpleData.rootPId;obj[options.data.simpleData.pId]="";obj.open=true;if(options.data.key.name){obj[options.data.key.name]="全部"}options.localdata.push(obj)}tree=$(this).zTree.init(treeobj,options,options.localdata)}else{if(options.url!=null){$.dajax({url:options.url,async:false,data:options.queryParam,success:function(data1){if(options.rootElement){var obj={};obj[options.data.simpleData.idKey]=options.data.simpleData.rootPId;obj[options.data.simpleData.pId]="";obj.open=true;if(options.data.key.name){obj[options.data.key.name]="全部"}data1.push(obj)}tree=$(this).zTree.init(treeobj,options,data1)}})}else{tree=$(this).zTree.init(treeobj,options)}}if(options.isOpen){tree.expandAll(true)}if(!options.ISLEAF&&options.checkType!="nocheck"){var node=tree.getNodes();var nodes=tree.transformToArray(node);for(var i=0;i<nodes.length;i++){if(nodes[i].ISLEAF==1){nodes[i].nocheck=false;tree.updateNode(nodes[i])}else{nodes[i].nocheck=true;tree.updateNode(nodes[i])}}}function beforeClick(treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeId);zTree.checkNode(treeNode,!treeNode.checked,null,true);return false}function onClick(e,treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeId);zTree.checkNode(treeNode,!treeNode.checked,null,true);return false}function onCheck(e,treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeId),nodes=zTree.getCheckedNodes(true),v="",dv="";for(var i=0,l=nodes.length;i<l;i++){v+=nodes[i][options.data.key.name]+",";dv+=nodes[i][options.data.simpleData.idKey]+","}if(v.length>0){v=v.substring(0,v.length-1);dv=dv.substring(0,dv.length-1)}if(options.isPopupTree){hideInp.attr("value",dv);target.attr("value",v)}}function showMenu(dtreeSel,dtreeObj){var dtreeOffset=dtreeSel.position();dtreeObj.css({left:dtreeOffset.left,top:dtreeSel.outerHeight(),paddingRight:"20px"}).slideDown("fast");$(document).on("mouseup",function(e){if(!dtreeSel.is(e.target)&&!dtreeObj.is(e.target)&&dtreeObj.has(e.target).length===0){dtreeObj.hide()}})}return tree};$.fn.dtable=function(options){var tableObj=$.replaceTag($(this),"TABLE");var setting={cache:false,height:options.searchbar!=undefined?$(document).height()-60:$(document).height(),cache:false,editable:false,showRefresh:true,pageNumber:1,pageSize:30,method:"post",pagination:true,paginationHAlign:"left",pageList:[10,20,30],striped:true,queryParamsType:"limit",contentType:"application/x-www-form-urlencoded",editable:false,mode:"inline",resizable:false,fixedColumns:false,autoRefreshTime:false,selectToEdit:false};if(typeof options==="string"&&options){return tableObj.bootstrapTable(options,Array.prototype.slice.call(arguments,1))}else{if(typeof options==="object"&&options){options=$.extend({},setting,options);var columnSetting={sortable:true};var subColumns=options.columns;var lastRow=[];if(typeof subColumns[0]=="object"&&typeof subColumns[0].length=="number"){for(var k=0;k<subColumns.length;k++){for(var j=0;j<subColumns[k].length;j++){if(subColumns[k][j].colspan==undefined){lastRow.push(subColumns[k][j])}}}}else{$.each(subColumns,function(key){if(subColumns[key].checkbox||subColumns[key].radio){}else{lastRow.push(subColumns[key])}})}for(var i=0;i<lastRow.length;i++){lastRow[i].sortable=true}$.include([__bootstrapVersionPath+"/plugins/table/css/bootstrap-table.css",__bootstrapVersionPath+"/plugins/table/js/bootstrap-table_v1.js",__bootstrapVersionPath+"/plugins/table/js/bootstrap-table-zh-CN.js",__bootstrapVersionPath+"/plugins/table/css/bootstrap-table-custom.css",__bootstrapVersionPath+"/plugins/table/js/inlineBox.js"]);$.include([__bootstrapVersionPath+"/plugins/table/js/table_editor.js"]);if(options.editable){if(options.columns!=null){var columndefault={mode:options.mode};for(var i=0;i<options.columns.length;i++){if(options.columns[i].editable!=null){options.columns[i].editable=$.extend({},columndefault,options.columns[i].editable)}}}$.include([__bootstrapVersionPath+"/plugins/table/js/bootstrap-editable.js",__bootstrapVersionPath+"/plugins/table/js/bootstrap-table-editable.js",__bootstrapVersionPath+"/plugins/table/css/bootstrap-editable.css"])}}}if(options.resizable){$.include([__bootstrapVersionPath+"/plugins/table/js/colResizable-1.6.js",__bootstrapVersionPath+"/plugins/table/js/bootstrap-table-resizable.js"])}if(options.fixedColumns){$.include([__bootstrapVersionPath+"/plugins/table/css/bootstrap-table-fixed-columns.css",__bootstrapVersionPath+"/plugins/table/js/bootstrap-table-fixed-columns.js"])}if(options.autoRefreshTime!==false){var refreshTime=parseInt(options.autoRefreshTime);if(!isNaN(refreshTime)){var timer=setInterval(function(){if(options.url===""||options.url==undefined){tableObj.bootstrapTable("load",options.data)}else{tableObj.bootstrapTable("refresh",{silent:true})}},refreshTime)}}if(options.selectToEdit){options.onCheck=function(row,$element){var tableData=tableObj.bootstrapTable("getData");$.each(tableData,function(key){tableObj.tableEditor("cancel",key)});var rowIndex=tableData.indexOf(row);var $tr=tableObj.find("tr[data-index]");if($element.find(".form-control").length===0){tableObj.tableEditor("init",rowIndex)}}}if(options.clickToSelect){options.onClickCell=function(field,value,row,$element){var opts=tableObj.bootstrapTable("getOptions");var colData=opts.columns[0];var rowIndex=opts.detailView?$element.index()-1:$element.index();var thisColData=colData[rowIndex];if(!thisColData.clickToSelect){thisColData.clickToSelect=true}if($element.attr("type")!==undefined){thisColData.clickToSelect=false}}}return tableObj.bootstrapTable(options)};$.extend({dinit:function(options){var defaultsetting={proving:true};options=$.extend({},defaultsetting,options);if(options.proving){$.include([__bootstrapVersionPath+"/plugins/layer/layer.js"]);$.include([__bootstrapVersionPath+"/plugins/layer/skin/default/layer.css"]);$(document).on("change","[proving]",function(){if(!$.dvalidate($(this))){layer.close($(this).attr("tipsid"));var index=layer.tips($("this").attr("title")==null?"输入数据错误":$("this").attr("title"),$(this),{tipsMore:true});$(this).attr("tipsid",index)}else{layer.close($(this).attr("tipsid"))}})}}});$.extend({dvalidate:function(obj){var provings=obj.attr("proving").split("|");for(var i=0;i<provings.length;i++){var value=obj.val();if(provings[i]=="notEmpty"){if(value==""){return false}}else{if(provings[i]=="email"){var myreg=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;if(value!=""&&!myreg.test(value)){return false}}else{if(provings[i]=="idcard"){if(value!=""&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(value)){return false}}else{if(provings[i]=="phone"){if(value!=""&&!/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/.test(value)){return false}}else{if(provings[i]=="url"){var RegUrl=new RegExp();RegUrl.compile("^[A-Za-z]+://[A-Za-z0-9-_]+\\.[A-Za-z0-9-_%&?/.=]+$");if(value!=""&&!RegUrl.test(value)){return false}}else{var f=eval(provings[i]);if(!f){return false}}}}}}}return true}});$.extend({dajax:function(options){$.include([__bootstrapVersionPath+"/plugins/layer/layer.js"]);$.include([__bootstrapVersionPath+"/plugins/layer/skin/default/layer.css"]);var index;var defaultsetting=$.extend({},{type:"POST",loadMsg:"加载中",dataType:"json",showLoading:true,beforeSend:function(xhr){if(options.showLoading){index=layer.load(1)}if(options.sendbefore){options.sendbefore(xhr)}},complete:function(){if(options.showLoading){layer.close(index)}}},$.dajaxConfig);options=$.extend({},defaultsetting,options);$.ajax(options)}});$.extend({editTableCell:function(settings){var defaultSettings={tableobj:$("#datatable"),rowNum:1,columnNum:1,editVal:{type:"text",title:"title"}};$.extend(defaultSettings,settings);var rowLen=settings.tableobj.find("tr").length;var columnLen=settings.tableobj.find("tr:eq(0)").children().length;var cell;drowNum=settings.rowNum;dcolumnNum=settings.columnNum-1;if(drowNum!=null&&dcolumnNum!=null){cell=settings.tableobj.find("tr").eq(drowNum).find("td").eq(dcolumnNum)}var tabledata=settings.tableobj.data("bootstrap.table");var index=drowNum-1;var datapk=tabledata.data[index].guid;var datafield=tabledata.columns[drowNum].field;var datavalue=cell.text();cell.wrapInner('<a href="javascript:void(0)" data-name="'+datafield+'" data-pk="'+datapk+'" data-value="'+datavalue+'"></a>');cell.find("a").editable(settings.editVal);return cell}});$.extend({dalert:function(options){$.include([__bootstrapVersionPath+"/plugins/layer/layer.js"]);$.include([__bootstrapVersionPath+"/plugins/layer/skin/default/layer.css"]);var defaultsetting={text:"",icon:1};options=$.extend({},defaultsetting,options);layer.alert(options.text,options)}});$.extend({dconfirm:function(options){$.include([__bootstrapVersionPath+"/plugins/layer/layer.js"]);$.include([__bootstrapVersionPath+"/plugins/layer/skin/default/layer.css"]);var defaultsetting={btn:["确定","取消"]};options=$.extend({},defaultsetting,options);var str="layer.confirm(options.text,options";if(options.funs!=null){for(var i=0;i<options.funs.length;i++){str+=",options.funs["+i+"]"}}str+=")";eval("("+str+")")}});$.extend({dloadformdata:function(obj,data,name){var dname="name";if(name!=null){dname=name}obj.find("["+dname+"]").each(function(){if($(this).attr("boxType")!=undefined){$(this).parent().find(".form-control")[$(this).attr("boxType")]("setValue",data[$(this).attr(dname)])}var key=$(this).attr(dname);if(data[key]!=null){$(this).val(data[key])}else{$(this).val("")}})}});$.extend({ddisable:function(obj,flag,name){var dname="name";if(name!=null){dname=name}obj.find("["+dname+"]").each(function(){$(this).attr("disabled",flag)})}});$.fn.dInputNumberAdd=function(numberType,defaultValue){var inputHtml='<input type="text" class="dnumberInputText" defaultvalue=""><input type="button" class="dnumberInputClear" value="清空">';$(this).append(inputHtml);var inputText=$(this).children("input").eq(0);var inputClear=$(this).children("input").eq(1);inputText.attr("onpaste","return false");inputText.attr("size","22");inputText.attr("style","ime-mode: disabled; margin: 0; padding: 0; text-indent: 5px;");if(numberType=="idcard"){inputText.attr("placeholder","请输入18位身份证号")}else{if(numberType=="tel"){inputText.attr("placeholder","请输入手机号或区号+固话号")}else{if(numberType=="number"){inputText.attr("placeholder","请输入...")}}}var idNo,telNo;if(defaultValue!=undefined&&defaultValue!=null&&$.trim(defaultValue)!="null"&&$.trim(defaultValue)!="undefined"&&$.trim(defaultValue)!=""){var defaultVal=$.trim(defaultValue);inputValChange(defaultVal);inputValNormal()}inputText.on("focus",function(){inputText.val(inputText.val().replace(/[\s\-]/g,""))});inputText.on("input propertychange",function(){inputValChange(inputText.val())});inputText.on("blur",function(){inputValNormal()});inputClear.on("click",function(){inputText.val("");idNo="";telNo="";inputText.focus()});function inputValChange(inputTextVal){if(numberType=="idcard"){if(inputTextVal.length<=17){inputText.val(inputTextVal.replace(/[^0-9]/g,""))}else{if(inputTextVal.length==18){inputText.val(inputTextVal.replace(/[^0-9xX]/g,""));inputText.val(inputTextVal.replace(/[x]/g,"X"))}else{inputText.val(inputTextVal.substring(0,18))}}idNo=inputText.val().substring(0,6)+" "+inputText.val().substring(6,14)+" "+inputText.val().substring(14)}else{if(numberType=="tel"){if(inputTextVal.substring(0,1)=="1"){telChoose(inputTextVal,11);telNo=inputText.val().substring(0,3)+" "+inputText.val().substring(3,7)+" "+inputText.val().substring(7)}else{if(inputTextVal.substring(0,1)=="8"){telChoose(inputTextVal,11);telNo=inputText.val().substring(0,3)+" - "+inputText.val().substring(3,7)+" "+inputText.val().substring(7)}else{if(inputTextVal.substring(0,1)=="0"){if(inputTextVal.substring(1,2)=="1"||inputTextVal.substring(1,2)=="2"){telChoose(inputTextVal,11);telNo=inputText.val().substring(0,3)+" - "+inputText.val().substring(3,7)+" "+inputText.val().substring(7)}else{telChoose(inputTextVal,12);telNo=inputText.val().substring(0,4)+" - "+inputText.val().substring(4,8)+" "+inputText.val().substring(8)}}else{inputText.val("")}}}}else{if(numberType=="number"){inputText.val(inputTextVal.replace(/[^0-9]/g,""))}}}}function telChoose(inputTextVal,telCount){if(inputTextVal.length>=(telCount+1)){inputText.val(inputTextVal.substring(0,telCount))}if(inputTextVal.length<=telCount){inputText.val(inputTextVal.replace(/[^0-9]/g,""))}else{inputText.val(inputTextVal.substring(0,telCount))}}function inputValNormal(){if(numberType=="idcard"&&$.trim(idNo)!=""){inputText.val(idNo)}else{if(numberType=="tel"&&$.trim(telNo)!=""){inputText.val(telNo)}}}};$.fn.dInputNumberValClear=function(isDefaultValue){if(isDefaultValue==false){$(this).children("input").eq(0).val("")}else{if(isDefaultValue==true){$(this).children("input").eq(0).val($(this).children("input").eq(0).attr("defaultValue"))}}};$.fn.dtreetable=function(options){$.include([__bootstrapVersionPath+"/plugins/treegrid/css/jquery.treegrid.css",__bootstrapVersionPath+"/plugins/treegrid/js/jquery.treegrid.js",__bootstrapVersionPath+"/plugins/treegrid/js/jquery.treegrid.bootstrap3.js"]);$this=$(this);if(options.columns){var columns=options.columns;var h="<tr>";for(var i=0;i<columns.length;i++){var st='style="';if(columns[i].width){st+="width: "+columns[i].width+"px;"}if(columns[i].hidden==true){st+="display:none;"}st+='"';h+="<th "+st+">"+columns[i].title+"</th>"}h+="</tr>";$(this).append(h)}if(options.localdata){addtr(options.localdata,options);if(options.loaded&&options.loaded!=null){options.loaded()}}else{if(options.url){$.dajax({url:options.url,data:options.data,success:function(data){addtr(data,options);if(options.loaded&&options.loaded!=null){options.loaded()}}})}}function addtr(datas,options){var parentfield=options.parentfield,selfidfield=options.selfidfield,isLeafField=options.isLeaffield,levelField=options.levelfield;$.each(datas,function(i,data){$tr=$("<tr/>");$tr.attr("treegrid",data[selfidfield]);if(data[parentfield]!=-1){$tr.attr("treegrid-parent",data[parentfield])}$.each(options.columns,function(y,column){$td=$("<td/>");if(column.hidden){$td.css({display:"none"})}if(y==0){for(var enptySpan=0;enptySpan<data[levelField];enptySpan++){$td.append("<span style='width: 16px;height:16px;display:inline-block;'>")}}if(column.isCount==true){var formatedNum=addzero(data[column.field]);if(data[isLeafField]==1){$td.append(' <span class="show_text td_value" >'+formatedNum+'</span><input type="text" class="show_input" style="display: none; margin: 0px;"/>')}else{if(data[selfidfield]!=0){$td.append('<span style="font-weight: bold;color:#0000ff" class="total td_value">'+formatedNum+"</span>")}}}else{$td.append("<span class='td_value'>"+data[column.field]+"</span>")}$tr.append($td)});$this.append($tr)});$(".show_text").parent().off("click").on("click",function(){var moneybox=$(this).children(".show_text");var show_input=moneybox.next(".show_input");show_input.val(moneybox.text());moneybox.hide();show_input.show().select();show_input.focus()});$(".show_input").off("blur").on("blur",function(){var show_input=$(this);var moneybox=show_input.prev(".show_text");moneybox.text(addzero(show_input.val()));moneybox.show();show_input.hide();count(show_input.parent().parent());if(options.onblur&&options.onblur!=null){options.onblur(show_input)}});$(".show_input").off("keypress").on("keypress",function(e){if(e.keyCode==13||e.keyCode==9){var nextrow=$(this).parent().parent().nextAll("tr").find(".show_input").eq(0).parent().parent();if(nextrow.is("tr")){nextrow.find(".show_input").val(nextrow.find(".show_text").text());nextrow.find(".show_input").show().select();nextrow.find(".show_text").hide()}else{$(this).blur()}}})}function count(node){var pid=node.attr("treegrid-parent");selectorP="[treegrid='"+pid+"']";var parentnode=$this.find(selectorP);selector="[treegrid-parent='"+pid+"']";var nodes=$this.find(selector);if(nodes.length==0){return}var t=0;for(var i=0;i<nodes.length;i++){if($(nodes[i]).find(".show_text").length!=0){t+=Number($(nodes[i]).find(".show_text").html())}else{t+=Number($(nodes[i]).find(".total").html())}}$(parentnode).find(".total").html(addzero(t));count(parentnode)}function addzero(value){var value=Math.round(parseFloat(value)*100)/100;var xsd=value.toString().split(".");if(xsd.length==1){value=value.toString()+".00";return value}if(xsd.length>1){if(xsd[1].length<2){value=value.toString()+"0"}return value}}};$.extend({dopen:function(options){$.include([__bootstrapVersionPath+"/plugins/layer/layer.js"]);$.include([__bootstrapVersionPath+"/plugins/layer/skin/default/layer.css"]);var defaultsetting={type:1,maxmin:true,parent:false,fixed:false};options=$.extend({},defaultsetting,options);if(options.parent&&self.location!=top.location){parent.$.dopen(options)}else{if(options.type=="5"){delete options.type;layer.tab(options)}else{layer.open(options)}}}});$.extend({copyToClipboard:function(elem){var targetId="_hiddenCopyText_";var isInput=elem.tagName==="INPUT"||elem.tagName==="TEXTAREA";var origSelectionStart,origSelectionEnd;if(elem.setSelectionRange===undefined){return false}if(isInput){target=elem;origSelectionStart=elem.selectionStart;origSelectionEnd=elem.selectionEnd}else{target=document.getElementById(targetId);if(!target){var target=document.createElement("textarea");target.style.position="absolute";target.style.left="-9999px";target.style.top="0";target.id=targetId;document.body.appendChild(target)}target.textContent=elem.textContent}var currentFocus=document.activeElement;target.focus();target.setSelectionRange(0,target.value.length);var succeed;try{succeed=document.execCommand("copy")}catch(e){succeed=false}if(currentFocus&&typeof currentFocus.focus==="function"){currentFocus.focus()}if(isInput){elem.setSelectionRange(origSelectionStart,origSelectionEnd)}else{target.textContent=""}return succeed}});$.fn.dsearchtree=function(options){$.include([__bootstrapVersionPath+"/css/font-awesome.min.css",__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.exhide.min.js"]);var target=$(this);var tree;var targetId;if(target.attr("id")){targetId=target.attr("id")}else{targetId="id"+(new Date().getTime());target.attr("id",targetId)}var settings={modalTitle:"查找名称",checkType:"nocheck",ISLEAF:false,check:{},data:{simpleData:{enable:true,idKey:"id",pIdKey:"pId",rootPId:"0"},key:{checked:"checked",children:"children",name:"name",title:"",url:""}},view:{fontCss:getFontCss},zindex:"999999",callback:{},onAckCallback:function(){return false}};options=$.extend({},settings,options);var html='<div class="modal fade" id="'+targetId+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+targetId+'_label" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title" id="'+targetId+'_label">'+options.modalTitle+'</h4></div><div class="modal-body"><input type="text" id="'+targetId+'_mdInput" class="form-control" placeholder="请输入关键字" value="" /><div class="treeWrap"><ul id="'+targetId+'_mdTree" class="ztree searchTree"></ul></div></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">关闭</button><button type="button" class="btn btn-primary" id="'+targetId+'_modalok">确定</button></div></div></div></div>';$("body").append(html);if(options.checkType=="radio"){options.check.enable="true";options.check.chkStyle="radio";options.check.radioType="all";options.callback.onClick=onClick;options.callback.onCheck=onCheck}else{if(options.checkType=="checkbox"){options.check.enable="true";options.callback.beforeClick=beforeClick;options.callback.onCheck=onCheck}}var treeobj=$("#"+targetId+"_mdTree");if(options.localdata!=null){tree=$.fn.zTree.init(treeobj,options,options.localdata)}else{if(options.url!=null){$.dajax({url:options.url,async:false,success:function(data1){tree=$.fn.zTree.init(treeobj,options,data1)}})}else{tree=$.fn.zTree.init(treeobj,options)}}target.wrap('<div class="ztreeBox_down"></div>');target.before('<input type="text" style="display:none;" id="'+targetId+'_hideInp"name="'+target.attr("name")+'" value="" txtvalue="" />');target.removeAttr("name");target.after('<i class="fa fa-angle-down"></i>');target.css({backgroundColor:"#FFF"});target.parent().attr({"data-target":"#"+targetId+"_modal","data-toggle":"modal"});target.attr({readonly:"true"});target.addClass("empty form-control");var treewrap=$("#"+targetId+"_modal").find(".treeWrap");treewrap.css({maxHeight:$(window).height()/2,overflowY:"scroll"});if(!options.ISLEAF&&options.checkType!="nocheck"){var node=tree.getNodes();var nodes=tree.transformToArray(node);for(var i=0;i<nodes.length;i++){if(nodes[i].ISLEAF==1){nodes[i].nocheck=false;tree.updateNode(nodes[i])}else{nodes[i].nocheck=true;tree.updateNode(nodes[i])}}}var key,lastValue="",nodeList=[],fontCss={},hideInp,checkedInpval,checkedInptxtval;hideInp=$("#"+targetId+"_hideInp");key=$("#"+targetId+"_mdInput");key.bind("focus",focusKey).bind("blur",blurKey).bind("propertychange",searchNode).bind("input",searchNode);$("#"+targetId+"_modal").on("shown.bs.modal",function(){$("#"+targetId+"_modal").css("z-index",options.zindex);if(options.cancelAll){var zTree=$.fn.zTree.getZTreeObj(targetId+"_mdTree");zTree.checkAllNodes(false)}});$("#"+targetId+"_modal").on("hidden.bs.modal",function(){if($(".modal.fade.in").length>0){$(".modal.fade.in").css({overflowY:"auto"})}});$("#"+targetId+"_modalok").on("click",function(){target.val(checkedInptxtval);target.attr("txtvalue",checkedInpval);hideInp.val(checkedInpval);$("#"+targetId+"_modal").modal("hide");target.change();target.data("noed",tree.getCheckedNodes());options.onAckCallback()});function focusKey(e){if(key.hasClass("empty")){key.removeClass("empty")}}function blurKey(e){if(key.get(0).value===""){key.addClass("empty")}}function searchNode(e){var zTree=$.fn.zTree.getZTreeObj(targetId+"_mdTree");var value=$.trim(key.get(0).value);var keyType=options.data.key.name;if(key.hasClass("empty")){value=""}if(lastValue===value){return}lastValue=value;if(value===""){zTree.showNodes(zTree.transformToArray(zTree.getNodes()));return}updateNodes(false);nodeList=zTree.getNodesByParamFuzzy(keyType,value);updateNodes(true)}function updateNodes(highlight){var zTree=$.fn.zTree.getZTreeObj(targetId+"_mdTree");var allNode=zTree.transformToArray(zTree.getNodes());zTree.hideNodes(allNode);for(var n in nodeList){findParent(zTree,nodeList[n]);nodeList[n].highlight=highlight;zTree.updateNode(nodeList[n])}zTree.showNodes(nodeList)}function findParent(zTree,node){zTree.expandNode(node,true,false,false);var pNode=node.getParentNode();if(pNode!=null){nodeList.push(pNode);findParent(zTree,pNode)}}function getFontCss(treeId,treeNode){return(!!treeNode.highlight)?{color:"#A60000","font-weight":"bold"}:{color:"inherit","font-weight":"inherit"}}function beforeClick(treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeId);zTree.checkNode(treeNode,!treeNode.checked,null,true);return false}function onClick(e,treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeId);zTree.checkNode(treeNode,!treeNode.checked,null,true);return false}function onCheck(e,treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeId),nodes=zTree.getCheckedNodes(true),v="",dv="";for(var i=0,l=nodes.length;i<l;i++){v+=nodes[i][options.data.key.name]+",";dv+=nodes[i][options.data.simpleData.idKey]+","}if(v.length>0){v=v.substring(0,v.length-1);dv=dv.substring(0,dv.length-1)}checkedInpval=dv;checkedInptxtval=v}};$.fn.ddragtree=function(options){$.include([__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js"]);var treeobj=$(this);var tree;var dragtreeId;treeobj.addClass("ztree");if(treeobj.attr("id")){dragtreeId=treeobj.attr("id")}else{dragtreeId="id"+(new Date().getTime());treeobj.attr("id",dragtreeId)}var settings={checkType:"nocheck",ISLEAF:false,check:{},edit:{drag:{autoExpandTrigger:true,prev:dropPrev,inner:dropInner,next:dropNext},enable:true,showRemoveBtn:false,showRenameBtn:false},data:{simpleData:{enable:true}},view:{dblClickExpand:false},callback:{beforeDrag:beforeDrag,beforeDrop:beforeDrop,beforeDragOpen:beforeDragOpen,onDrag:onDrag,onDrop:onDrop,onExpand:onExpand,beforeClick:beforeClick}};options=$.extend({},settings,options);if(options.checkType=="radio"){options.check.enable="true";options.check.chkStyle="radio";options.check.radioType="all"}else{if(options.checkType=="checkbox"){options.check.enable="true"}}if(options.localdata!=null){tree=$.fn.zTree.init(treeobj,options,options.localdata)}else{if(options.url!=null){$.dajax({url:options.url,async:false,success:function(data1){tree=$.fn.zTree.init(treeobj,options,data1)}})}else{tree=$.fn.zTree.init(treeobj,options)}}if(!options.ISLEAF&&options.checkType!="nocheck"){var node=tree.getNodes();var nodes=tree.transformToArray(node);for(var i=0;i<nodes.length;i++){if(nodes[i].ISLEAF==1){nodes[i].nocheck=false;tree.updateNode(nodes[i])}else{nodes[i].nocheck=true;tree.updateNode(nodes[i])}}}function dropPrev(treeId,nodes,targetNode){var pNode=targetNode.getParentNode();if(pNode&&pNode.dropInner===false){return false}else{for(var i=0,l=curDragNodes.length;i<l;i++){var curPNode=curDragNodes[i].getParentNode();if(curPNode&&curPNode!==targetNode.getParentNode()&&curPNode.childOuter===false){return false}}}return true}function dropInner(treeId,nodes,targetNode){if(targetNode&&targetNode.dropInner===false){return false}else{for(var i=0,l=curDragNodes.length;i<l;i++){if(!targetNode&&curDragNodes[i].dropRoot===false){return false}else{if(curDragNodes[i].parentTId&&curDragNodes[i].getParentNode()!==targetNode&&curDragNodes[i].getParentNode().childOuter===false){return false}}}}return true}function dropNext(treeId,nodes,targetNode){var pNode=targetNode.getParentNode();if(pNode&&pNode.dropInner===false){return false}else{for(var i=0,l=curDragNodes.length;i<l;i++){var curPNode=curDragNodes[i].getParentNode();if(curPNode&&curPNode!==targetNode.getParentNode()&&curPNode.childOuter===false){return false}}}return true}var className="dark",curDragNodes,autoExpandNode;function beforeDrag(treeId,treeNodes){className=(className==="dark"?"":"dark");for(var i=0,l=treeNodes.length;i<l;i++){if(treeNodes[i].drag===false){curDragNodes=null;return false}else{if(treeNodes[i].parentTId&&treeNodes[i].getParentNode().childDrag===false){curDragNodes=null;return false}}}curDragNodes=treeNodes;return true}function beforeDragOpen(treeId,treeNode){autoExpandNode=treeNode;return true}function beforeDrop(treeId,treeNodes,targetNode,moveType,isCopy){className=(className==="dark"?"":"dark");return true}function onDrag(event,treeId,treeNodes){className=(className==="dark"?"":"dark")}function onDrop(event,treeId,treeNodes,targetNode,moveType,isCopy){className=(className==="dark"?"":"dark")}function onExpand(event,treeId,treeNode){if(treeNode===autoExpandNode){className=(className==="dark"?"":"dark")}}function beforeClick(treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeId);zTree.checkNode(treeNode,!treeNode.checked,null,true);return false}};$.fn.dedittree=function(options){$.include([__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js"]);var treeobj=$(this);var tree,newtree;var edittreeId;if(treeobj.attr("id")){edittreeId=treeobj.attr("id")}else{edittreeId="id"+(new Date().getTime());treeobj.attr("id",edittreeId)}var settings={checkType:"nocheck",ISLEAF:false,check:{},view:{addHoverDom:addHoverDom,removeHoverDom:removeHoverDom,selectedMulti:false},edit:{enable:true,editNameSelectAll:true},data:{simpleData:{enable:true}},callback:{beforeDrag:beforeDrag,beforeEditName:beforeEditName,beforeRemove:beforeRemove,beforeRename:beforeRename,onRemove:onRemove,onRename:onRename,beforeClick:beforeClick}};options=$.extend({},settings,options);if(options.checkType=="radio"){options.check.enable="true";options.check.chkStyle="radio";options.check.radioType="all"}else{if(options.checkType=="checkbox"){options.check.enable="true"}}if(options.localdata!=null){tree=$.fn.zTree.init(treeobj,options,options.localdata)}else{if(options.url!=null){$.dajax({url:options.url,async:false,success:function(data1){tree=$.fn.zTree.init(treeobj,options,data1)}})}else{tree=$.fn.zTree.init(treeobj,options)}}newtree=$.fn.zTree.getZTreeObj(edittreeId).getNodes();if(!options.ISLEAF&&options.checkType!="nocheck"){var node=tree.getNodes();var nodes=tree.transformToArray(node);for(var i=0;i<nodes.length;i++){if(nodes[i].ISLEAF==1){nodes[i].nocheck=false;tree.updateNode(nodes[i])}else{nodes[i].nocheck=true;tree.updateNode(nodes[i])}}}var className="dark";function beforeDrag(treeId,treeNodes){return false}function beforeEditName(treeId,treeNode){className=(className==="dark"?"":"dark");var zTree=$.fn.zTree.getZTreeObj(edittreeId);zTree.selectNode(treeNode)}function beforeRemove(treeId,treeNode){className=(className==="dark"?"":"dark");var zTree=$.fn.zTree.getZTreeObj(edittreeId);zTree.selectNode(treeNode);return confirm("确定删除节点 "+treeNode.name+" 吗？")}function beforeRename(treeId,treeNode,newName,isCancel){className=(className==="dark"?"":"dark");if(newName.length==0){alert("节点名称不能为空");var zTree=$.fn.zTree.getZTreeObj(edittreeId);setTimeout(function(){zTree.editName(treeNode)},10);return false}return true}function onRemove(e,treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(edittreeId);newtree=zTree.getNodes()}function onRename(e,treeId,treeNode,isCancel){var zTree=$.fn.zTree.getZTreeObj(edittreeId);newtree=zTree.getNodes()}function showRemoveBtn(treeId,treeNode){return !treeNode.isFirstNode}function showRenameBtn(treeId,treeNode){return !treeNode.isLastNode}var newCount=1;function addHoverDom(treeId,treeNode){var sObj=$("#"+treeNode.tId+"_span");if(treeNode.editNameFlag||$("#addBtn_"+treeNode.tId).length>0){return}var addStr="<span class='button add' id='addBtn_"+treeNode.tId+"' title='add node' onfocus='this.blur();'></span>";sObj.after(addStr);var btn=$("#addBtn_"+treeNode.tId);if(btn){btn.bind("click",function(){var zTree=$.fn.zTree.getZTreeObj(edittreeId);zTree.addNodes(treeNode,{id:(100+newCount),pId:treeNode.id,name:"new node"+(newCount++)});return false})}}function removeHoverDom(treeId,treeNode){$("#addBtn_"+treeNode.tId).unbind().remove()}function beforeClick(treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(edittreeId);zTree.checkNode(treeNode,!treeNode.checked,null,true);return false}return newtree};$.include([__bootstrapVersionPath+"/config/config.js|likeafter|js/jquery.js",__bootstrapVersionPath+"/js/bootstrap.min.js|likeafter|js/jquery.js",__bootstrapVersionPath+"/css/bootstrap.min.css|likeafter|js/jquery.js",__bootstrapVersionPath+"/css/bootstrap.dataenw.css|likeafter|css/bootstrap.min.css"]);if(navigator.userAgent.indexOf("MSIE")>0&&(navigator.userAgent.indexOf("MSIE 6.0")>0||navigator.userAgent.indexOf("MSIE 7.0")>0||navigator.userAgent.indexOf("MSIE 8.0")>0)){$.include([__bootstrapVersionPath+"/js/respond.min.js",__bootstrapVersionPath+"/js/html5shiv.min.js"])}$.dinit()})(jQuery);(function(b){var a=function(d,c){this.options=c;this.$el=b(d);this.selectData=this.options.localdata;this.init()};a.defaults={textField:"text",valueField:"id",url:"",localdata:[],onChange:function(c){return false}};a.prototype.appendOption=function(d,e,f){this.$el.find("option").remove();if(this.options.searchOption==true){this.$el.append("<option value=''>全部</option>")}else{if(this.options.searchOption==false){this.$el.append("<option value=''></option>")}}for(var c=0;c<d.length;c++){this.$el.append("<option value='"+d[c][e]+"'>"+d[c][f]+"</option>")}b(this).data("oldValue",this.$el.val())};a.prototype.init=function(){var e,f,c,d;d=this;e=this.options.valueField;f=this.options.textField;c=this.options.url;if(c!=""){b.dajax({url:c,success:function(g){if(g.length==0){return}d.selectData=g;d.appendOption(d.selectData,e,f)}})}this.appendOption(this.selectData,e,f);this.$el.off("change").on("change",function(){var g=d.$el.find("option:selected").index();d.options.onChange.apply(d.options,[d.selectData[g],b(d).data("oldValue")]);b(d).data("oldValue",d.$el.val())})};a.prototype.getValue=function(){return this.$el.val()};a.prototype.setValue=function(c){this.$el.val(c)};a.prototype.disable=function(){this.$el.attr("disabled","disabled")};a.prototype.enable=function(){this.$el.removeAttr("disabled")};a.prototype.loadData=function(c){this.selectData=c;this.$el.children().remove();this.appendOption(c,this.options.valueField,this.options.textField)};b.fn.dselect=function(c){var f=b(this);if(typeof c=="object"){c=b.extend(true,{},a.defaults,c);f.data("Dselect",new a(f,c));return}if(typeof c=="string"){var d,g=Array.prototype.slice.call(arguments,1),e=b(this).data("Dselect");d=e[c].apply(e,g);return typeof d==="undefined"?this:d}}})(jQuery);(function(a){a.extend({buttonDefault:{text:" ",icon:"",size:"",type:"",handler:function(){}}});a.fn.dbutton=function(b){var c=a.replaceTag(a(this),"BUTTON"),b=a.extend({},a.buttonDefault,b);c.attr("type","button").addClass("btn btn-default");if(b.type!=""){c.addClass("btn-"+b.type)}if(b.size!=""){c.addClass("btn-"+b.size)}if(b.icon!=""){if(b.icon.indexOf("glyphicon-")!=-1){a("<span class='glyphicon'>").appendTo(c).addClass(b.icon)}else{c.addClass(b.icon)}}if(b.text!=""){c.append(b.text)}c.on("click",function(){b.handler.apply(this)})}})(jQuery);if(!Array.prototype.map){Array.prototype.map=function(i,h){var b,a,c;if(this==null){throw new TypeError(" this is null or not defined")}var e=Object(this);var f=e.length>>>0;if(Object.prototype.toString.call(i)!="[object Function]"){throw new TypeError(i+" is not a function")}if(h){b=h}a=new Array(f);c=0;while(c<f){var d,g;if(c in e){d=e[c];g=i.call(b,d,c,e);a[c]=g}c++}return a}}if(typeof Array.prototype.forEach!="function"){Array.prototype.forEach=function(b){for(var a=0;a<this.length;a++){b.apply(this,[this[a],a,this])}}}(function(f){f.treeTableDefault={height:"",columns:[],headers:null,treeMode:"gird",useLine:true,useIcon:true,id:"",useCookie:false,onExpandNodeEvents:[],themeName:"arrow",selectMode:"single",idKey:"id",pIdKey:"pid"};var b=function(h){var i={};h.forEach(function(j){i[j.field]=j.title});return i};var a=function(h){return h.map(function(i){return{dataIndex:i.field,width:i.width+"",align:i.align==undefined?"left":i.align,isNodeClick:i.nodeControl==true,renderFunction:i.formatter==undefined?null:i.formatter}})};var g=function(h){return[{columns:a(h).map(function(i){return{dataIndex:i.dataIndex}}),dataObject:b(h),trAttributeNames:["classStyle","style"],trAttributeValueObject:{classStyle:"headerbg",style:""}}]};var e=function(i,h){this.target=i;this.options=h};var d,c;f.fn.treeGrid=function(t){var o=f(this);var s=function(u){return u.map(function(v){if(!v.id){v.id=v[d]}if(!v.pid){v.pid=v[c]}v.dataObject=f.extend(true,{},v);if(t.isOpen==true){v.isOpen=true}return v})};if(typeof t=="object"){f.include([__bootstrapVersionPath+"/plugins/treegrid2/css/tabletree4j.css",__bootstrapVersionPath+"/plugins/treegrid2/js/Core4j.js",__bootstrapVersionPath+"/plugins/treegrid2/js/TableTree4j-debug.js"]);var j=t.columns;d=t.idKey;c=t.pIdKey;t.headers=g(j);t.columns=a(j);t.renderTo=o.attr("id");t=f.extend({},f.treeTableDefault,t);var m=new Core4j.toolbox.TableTree4j(t);o.data("treeGrid",m);if(t.url){f.dajax({url:t.url,success:function(u){m.build(s(u),true)}})}else{m.build(s(t.data),true)}if(o[0].className.indexOf("_subTable")==-1){if(t.height!=""){o.height(t.height).css({overflow:"auto"})}var r=o.wrap("<div class='tableWrap'></div>").parent();var k=t.headers[0].dataObject;var j=t.columns;var p=0;var n=r.prepend("<div class='fixedHeader'><table class='tabletree4j-gird'></table></div>").find(".fixedHeader");if(t.height!=""&&t.height<o.find("table").height()){n.css({"margin-right":i()})}}}if(typeof t=="string"){var q,h=Array.prototype.slice.call(arguments,1),l=o.data("treeGrid");if(t=="transData"){return s(h[0])}q=l[t].apply(l,h);return typeof q==="undefined"?this:q}function i(){var x=document.createElement("p"),w={width:"100px",height:"100px",overflowY:"scroll"},u,v;for(u in w){x.style[u]=w[u]}document.body.appendChild(x);v=x.offsetWidth-x.clientWidth;document.body.removeChild(x);return v}}})(jQuery);(function(b){var c=function(f,e){this.options=e;this.target=b(f);this.deskMain;this.deskBottom;this.mainMenu;this.deskBtmTab;this.menuTree;this.ztree;this.init()};var d,a;c.DEFAULTS={showNotice:true,showTodoList:true,defaultIcon:"./images/win_icon.png",dragOptions:{containment:".deskMain",scroll:false,grid:[100,100],start:function(e,f){d=b(e.target).css("left");a=b(e.target).css("top")},drag:function(f,g){var h=b(f.target),e=g.position;if(e.top>=0&&e.top<=20&&e.left>=0&&e.left<=20){h.addClass("desk_del_mask")}else{h.removeClass("desk_del_mask")}},stop:function(g,h){var i=b(g.target),f=h.position;if(f.top>=0&&f.top<=20&&f.left>=0&&f.left<=20){i.remove()}var e=i.data("id");b(".deskItem[data-drag='draggable']").each(function(l){var j=b(this).data("id");if(e!==j){var k=parseInt(b(this).css("left"));var m=parseInt(b(this).css("top"));if(k===f.left&&m===f.top){i.css({left:d,top:a})}}})}},checkType:"nocheck",view:{showLine:false,dblClickExpand:false},data:{key:{durl:"url"}},callback:{},onDeskLoaded:function(e){}};c.prototype.init=function(){this.initDeskMain();this.initDeskBottom();this.initMenuTree()};c.prototype.initDeskMain=function(){var i=b(this),e=this.options,h=this.target,f=this;var g='<div class="deskWrap">    <div class="deskMain">        <div class="deskItem desk_trash">            <div class="item-trash"><i class="glyphicon glyphicon-trash"></i></div>            <p class="textover-ell item-txt">回收站</p>        </div>    </div>    <div class="deskBottom clearfix">        <div class="pull-left showMenu"><img src="./images/favicon.png" /></div>        <div class="pull-left">            <ul class="deskBtmTab clearfix"></ul>        </div>        <div class="pull-right systemInfo clearfix">            <div class="pull-right btn-group dropup">                <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                    <span class="caret"></span>                </button>                <ul class="dropdown-menu dropdown-menu-right">                    <li><a href="javascript:void(0);"><i class="glyphicon glyphicon-lock"></i>&nbsp;&nbsp;修改密码</a></li>                    <li><a href=""><i class="glyphicon glyphicon-log-out"></i>&nbsp;&nbsp;退出</a></li>                </ul>            </div>            <div class="pull-right baseInfo">                <span><i class="glyphicon glyphicon-time"></i>&nbsp;今天是<b class="today"></b></span>                <span><i class="glyphicon glyphicon-user"></i>&nbsp;您好！<b class="user">admin</b></span>            </div>        </div>    </div>    <div class="mainMenu">        <ul class="menuTree"></ul>    </div></div>';h.append(g).css({width:"100%",height:"100%"});b("body").attr({oncontextmenu:"self.event.returnValue=false",onselectstart:"return false"});f.deskMain=h.find(".deskMain");f.deskBottom=h.find(".deskBottom");f.deskBtmTab=h.find(".deskBtmTab");f.mainMenu=h.find(".mainMenu");f.menuTree=h.find(".menuTree");h.find(".showMenu").on("click",function(){if(f.mainMenu.is(":hidden")){f.mainMenu.slideDown(200);b(document).mouseup(function(j){if(!f.mainMenu.is(j.target)&&f.mainMenu.has(j.target).length===0){f.hideMainMenu()}})}else{f.hideMainMenu()}});f.deskMain.on("click",function(l){var j=b(l.target).attr("class");if(j.indexOf("deskItem")===-1&&!b(l.target).parent().is(".deskItem")){b(".deskItem").removeClass("deskItemActive")}var k=b(this).find("[role='tooltip']");f.removeTooltip(k)}).on("dblclick",".desk_icon",function(){f.openWindow(this)}).on("mousedown",".desk_icon",function(l){var k=b(this);if(l.which===1){k.addClass("deskItemActive").find("p").removeClass("textover-ell").end().siblings().removeClass("deskItemActive").find("p").addClass("textover-ell")}else{if(l.which===3){k.addClass("deskItemActive").siblings().removeClass("deskItemActive");if(k.find("[role='tooltip']").length===0){var j='<div class="tooltip right showShortCut" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"><p class="tooltip_menu removeShortcut">删除快捷方式</p></div></div>';setTimeout(function(){k.append(j);var m=b(".showShortCut");f.removeTooltip(m)},200)}}}b(".removeShortcut").on("click",function(){k.remove()})});f.options.dragOptions.containment=f.target.find(".deskMain");b("[data-drag='draggable']").draggable(f.options.dragOptions)};c.prototype.initDeskBottom=function(){var f=this,e=f.deskBtmTab,g=f.deskBottom;f.target.find(".today").html(f.getToday());e.on("click","li",function(){var j=b(this).attr("data-layerId");var i=b("#"+j);var h=f.arrSort()+1;if(i.is(":hidden")){i.show().css({zIndex:h+1}).attr("data-zindex",h+1);b(this).addClass("tabActive").siblings().removeClass("tabActive")}else{if(!b(this).hasClass("tabActive")){if(h!==parseInt(b(this).attr("data-zindex"))){i.css({zIndex:h+1}).attr("data-zindex",h+1);b(this).addClass("tabActive").siblings().removeClass("tabActive")}}else{if(b(this).hasClass("tabActive")){i.hide();b(this).removeClass("tabActive")}}}});g.on("mousedown",function(i){if(i.which===3&&b(this).find(".btmTab_item").length>0){var h='<div class="tooltip top closeAllOpen" role="tooltip" style="left:'+i.pageX+'px;"><div class="tooltip-arrow"></div><div class="tooltip-inner"><p class="tooltip_menu menu_closeAll">关闭所有</p><p class="tooltip_menu menu_hideAll">显示桌面</p></div></div>';setTimeout(function(){b("body").append(h);var j=b(".closeAllOpen");f.removeTooltip(j)},200)}});b("body").on("click",".menu_closeAll",function(){layer.closeAll();b(".closeAllOpen").remove()}).on("click",".menu_hideAll",function(){b(".layui-layer").each(function(){b(this).hide();f.deskBtmTab.find("li").removeClass("tabActive")});b(".closeAllOpen").remove()})};c.prototype.initMenuTree=function(){var e=this.options,f=this;e.callback.clickNode=function(l,k,j,i){var h=b("#"+k).tree("getTree");h.expandNode(j);if(!!j[h.setting.data.key.durl]){f.openWindow(j);f.hideMainMenu()}};e.callback.onRightClick=function(j,i,h){if(h!=null){b("#"+i).find("a").removeClass("treeNode");b("#"+h.tId+"_a").addClass("treeNode");f.showDropdownMenu(h)}};var g=f.menuTree.attr("id")!=null?f.menuTree.attr("id"):"ztree_"+new Date().getTime();f.menuTree.attr({id:g}).tree(e)};c.prototype.showDropdownMenu=function(i){var g=this,k=g.menuTree,f=k.tree("getTree");var j=b("#"+i.tId);if(j.find("[role='tooltip']").length===0&&!!i[f.setting.data.key.durl]){var e="<div class='tooltip bottom createShortcut' role='tooltip'><div class='tooltip-arrow'></div><div class='tooltip-inner'><p class='tooltip_menu menu_createShortcut'>创建快捷方式</p></div></div>";j.append(e);b(".tooltip_menu").on("click",function(){j.find("[role='tooltip']").remove();g.hideMainMenu()});b(".menu_createShortcut").on("click",function(){var o=i[f.setting.data.simpleData.idKey],m=i[f.setting.data.key.name],l=i[f.setting.data.key.durl],n=i[f.setting.data.key.icon];g.createShortcut(i)});var h=b(".createShortcut");g.removeTooltip(h)}};c.prototype.createShortcut=function(j){var n=this,m=n.options.defaultIcon,q=n.options.dragOptions,k=n.deskMain,e=n.menuTree,i=e.tree("getTree");var f=[];b(".deskItem").each(function(s){var r=parseInt(b(this).css("left"));var t=parseInt(b(this).css("top"));f.push({left:r,top:t})});var l=Math.ceil(k.width()/100);var h=Math.ceil(k.height()/100);if(l*100-k.width()>20){l=l-1}if(h*100-k.height()>30){h=h-1}if(f.length>=l*h){b.dalert({text:"桌面快捷方式已满，无法添加",icon:2});return false}var g=(j.icon===undefined||j.icon==null||j.icon==="")?m:j.icon;if(b(".desk_icon[data-id='"+j.id+"']").length===0){var o=n.setItemPos(f,l,h);var p='<div class="deskItem desk_icon" data-drag="draggable" data-type="deskIcon" data-id="'+j.id+'" data-url="'+j.url+'"><img src="'+g+'" class="item-img" alt=""/><span class="badge item-badge"></span><p class="textover-ell item-txt">'+j.name+"</p></div>";b(p).appendTo(k).css(o);b(".desk_icon").last().draggable(q)}n.hideMainMenu()};c.prototype.setItemPos=function(g,e,n){var f=[];for(var l=0;l<e;l++){for(var k=0;k<n;k++){f.push({left:l*100,top:k*100})}}for(var h=0;h<e;h++){for(var o=0;o<n;o++){b.each(g,function(i,j){if(j.left===h*100&&j.top===o*100){delete f[h*n+o];return true}})}}var m;b.each(f,function(i){if(f[i]!=undefined||f[i]!=null){m=f[i];return false}});return m};c.prototype.showDeskIcon=function(){var k=this,j=k.deskMain,f=j.find(".deskItem"),m=f.length;var g=100,h=100;var e=Math.round(j.height()/h),l=0,i=Math.ceil(m/e);b.each(f,function(n){b(this).css({position:"absolute",left:g*l,top:h*(n%e)});if((n+1)%e===0&&n!==0){l++}})};c.prototype.openWindow=function(k){var o=this,l=o.deskMain,i=o.deskBottom,f=o.deskBtmTab,n=o.options.defaultIcon,j=o.menuTree.tree("getTree");var g,q,e,u;if(k.nodeType===1){g=b(k).attr("data-id");q=b(k).attr("data-url");e=b(k).find(".item-img").attr("src");u=b(k).find(".item-txt").text()}else{var m=k[j.setting.data.key.icon];g=k[j.setting.data.simpleData.idKey];q=k[j.setting.data.key.durl];e=(m===undefined||m==null||m==="")?n:m;u=k[j.setting.data.key.name]}var t="<img src='"+e+"' />"+u,h;var s=b(window).height()-i.height();if(b(".layui-layer[data-id='"+g+"']").length===0){b.dopen({type:2,title:"<div class='windowTit'>"+t+"</div>",area:["100%",s+"px"],content:q,shade:0,offset:"t",success:function(x,A){h=x.attr("id");var y="<li class='btmTab_item tabActive' data-layerId='"+h+"'>"+t+"</li>";f.find("li").removeClass("tabActive");f.append(y);var w=o.arrSort()+1;x.css({zIndex:w}).attr({"data-zindex":x.css("z-index"),"data-id":g});var z=i.width()-b(".showMenu").outerWidth()-b(".systemInfo").outerWidth();if(navigator.userAgent.indexOf("MSIE")>0&&(navigator.userAgent.indexOf("MSIE 6.0")>0||navigator.userAgent.indexOf("MSIE 7.0")>0||navigator.userAgent.indexOf("MSIE 8.0")>0)){z=z-50}var B=0;f=o.deskBtmTab;b.each(f.find("li"),function(){B+=b(this).outerWidth()});if(B>=z){f.css("max-width",z);var v=f.find("li").length;f.find("li").width(Math.floor(z/v)-30)}},min:function(v){v.hide();f.find("[data-layerId="+h+"]").removeClass("tabActive");return false},full:function(v){var w=l.outerHeight(true);var x=w-b(".layui-layer-title").outerHeight();v.css({height:w,top:0});v.find("iframe").css("height",x)},end:function(){f.find("[data-layerId="+h+"]").remove()}})}else{var p=b(".layui-layer[data-id='"+g+"']");var r=o.arrSort()+1;p.show().css({zIndex:r}).attr({"data-zindex":p.css("z-index")})}};c.prototype.getToday=function(){var f=new Date();var g=f.getFullYear();var h=f.getMonth()+1;var e=f.getDate();return g+"年"+h+"月"+e+"日"};c.prototype.arrSort=function(){var e=[];b(".layui-layer").each(function(){e.push(parseInt(b(this).attr("data-zindex")))});e.sort(function(g,f){return f-g});return e[0]};c.prototype.saveDesktop=function(){var e=this.target.find(".deskMain").html();b.ajax({url:"user/saveDesktop.do",type:"POST",data:{html:e}})};c.prototype.initDesktop=function(){b.ajax({url:"user/getDesktop.do",type:"POST",dataType:"json",success:function(e){if(e.success){this.target.find(".deskMain").html(e.content);b("[data-drag='draggable']").draggable(this.options.dragOptions)}}})};c.prototype.removeTooltip=function(e){b(document).mouseup(function(f){if(!e.is(f.target)&&e.has(f.target).length===0){e.remove()}})};c.prototype.hideMainMenu=function(){this.mainMenu.fadeOut(10)};c.prototype.addDeskItem=function(e,f){if(e==="notice"){}else{if(e==="todolist"){}else{if(e==="icon"){this.createShortcut(f)}}}};c.prototype.removeDeskItem=function(f){var e=this.deskMain;e.find(".deskItem[data-id="+f+"]").remove()};c.prototype.getAllDeskItem=function(){var e=this,f=e.target,g=[];f.find(".desk_icon").each(function(j){var h=parseInt(b(this).css("left"));var k=parseInt(b(this).css("top"));g.push({left:h,top:k})})};b.fn.desktop=function(e){var h=b(this),g=null;if(typeof e==="object"){b.include([__bootstrapVersionPath+"/plugins/desktop/desktop.css",__bootstrapVersionPath+"/js/jquery-ui.js"]);g=h.data("desktop");if(g!=null){g.options=b.extend({},g.options,e);return}e=b.extend({},c.DEFAULTS,e);h.data("desktop",new c(h,e));h.data("type","desktop");e.onDeskLoaded.call(this,h);return}if(typeof e==="string"){var f,i=Array.prototype.slice.call(arguments,1),g=h.data("desktop");f=g[e].apply(g,i);return typeof f==="undefined"?this:f}}})(jQuery);